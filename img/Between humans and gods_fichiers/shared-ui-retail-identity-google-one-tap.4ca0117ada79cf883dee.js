/*@license For license information please refer to shared-ui-retail-identity-google-one-tap.licenses.txt*/
(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[8685],{9294:function(n,e,t){t.d(e,{K:function(){return H}});var o=t(67294),r=t(95878),a=t(69430),i=t(71641),c=t(98250),u=t(50319);function l(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,o=new Array(e);t<e;t++)o[t]=n[t];return o}function s(n,e,t,o,r,a,i){try{var c=n[a](i),u=c.value}catch(l){return void t(l)}c.done?e(u):Promise.resolve(u).then(o,r)}function d(n){return function(){var e=this,t=arguments;return new Promise((function(o,r){var a=n.apply(e,t);function i(n){s(a,o,r,i,c,"next",n)}function c(n){s(a,o,r,i,c,"throw",n)}i(void 0)}))}}function v(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function f(n,e){if(null==n)return{};var t,o,r=function(n,e){if(null==n)return{};var t,o,r={},a=Object.keys(n);for(o=0;o<a.length;o++)t=a[o],e.indexOf(t)>=0||(r[t]=n[t]);return r}(n,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(n);for(o=0;o<a.length;o++)t=a[o],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(n,t)&&(r[t]=n[t])}return r}function p(n,e){return function(n){if(Array.isArray(n))return n}(n)||function(n,e){var t=null==n?null:"undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(null!=t){var o,r,a=[],i=!0,c=!1;try{for(t=t.call(n);!(i=(o=t.next()).done)&&(a.push(o.value),!e||a.length!==e);i=!0);}catch(u){c=!0,r=u}finally{try{i||null==t.return||t.return()}finally{if(c)throw r}}return a}}(n,e)||function(n,e){if(!n)return;if("string"==typeof n)return l(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);"Object"===t&&n.constructor&&(t=n.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return l(n,e)}(n,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(n,e){return e||(e=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(e)}}))}function g(n,e){var t,o,r,a,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,o&&(r=2&a[0]?o.return:a[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,a[1])).done)return r;switch(o=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,o=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(r=i.trys,(r=r.length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){i.label=a[1];break}if(6===a[0]&&i.label<r[1]){i.label=r[1],r=a;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(a);break}r[2]&&i.ops.pop(),i.trys.pop();continue}a=e.call(n,i)}catch(c){a=[6,c],o=0}finally{t=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}function m(){var n=y(["\n  fragment IdentityAnalyticsInteractionEventFragment on IdentityAnalyticsInteractionEvent {\n    eventName\n    eventVersion\n    payload\n  }\n"]);return m=function(){return n},n}function _(){var n=y(["\n  fragment IdentityAnalyticsOutcomeEventFragment on IdentityAnalyticsOutcomeEvent {\n    eventName\n    eventVersion\n    payload\n  }\n"]);return _=function(){return n},n}function b(){var n=y(["\n  fragment IdentityOneTapSubmitActionFragment on IdentityOneTapSubmitAction {\n    atoActions {\n      ... on IdentityCsrfWidgetAction {\n        inputKeys\n        token\n        type\n      }\n    }\n    nonce\n    context\n    clickStreamAnalytics {\n      ...IdentityAnalyticsInteractionEventFragment\n      ...IdentityAnalyticsOutcomeEventFragment\n    }\n  }\n  ","\n  ","\n"]);return b=function(){return n},n}function O(){var n=y(["\n  mutation GoogleOneTapSubmit($context: ContextInput!, $submitRequest: IdentitySubmitRequestInput!) {\n    googleOneTapSubmit(context: $context, submitRequest: $submitRequest) {\n      ... on IdentityGoogleOneTapMutationResponse {\n        analytics {\n          ...IdentityAnalyticsOutcomeEventFragment\n        }\n        cmsToken\n        flow\n        scenario\n        success\n        variant\n      }\n    }\n  }\n  ","\n"]);return O=function(){return n},n}function I(){var n=y(["\n  fragment IdentityAnalyticsImpressionEventFragment on IdentityAnalyticsImpressionEvent {\n    eventName\n    eventVersion\n    payload\n  }\n"]);return I=function(){return n},n}function E(){var n=y(["\n  fragment IdentityGoogleOneTapResponseFragment on IdentityGoogleOneTapResponse {\n    analytics {\n      ...IdentityAnalyticsImpressionEventFragment\n      ...IdentityAnalyticsInteractionEventFragment\n    }\n    configuration {\n      clientId\n    }\n    action {\n      ...IdentityOneTapSubmitActionFragment\n    }\n  }\n\n  ","\n  ","\n  ","\n"]);return E=function(){return n},n}function T(){var n=y(["\n  query GoogleOneTapQuery($context: ContextInput!) {\n    googleOneTap(context: $context) {\n      ...IdentityGoogleOneTapResponseFragment\n    }\n  }\n\n  ","\n"]);return T=function(){return n},n}var h,A=function(n){var e=function(n){var e=n.event_data.event,t=e.event_type,o=e.event_name,r=e.event_category,a=e.event_version,i=e.action_location,c=e.action_reason,u=n.event_data.experience;return{event:{event_type:t,event_name:o,event_category:r,event_version:a,action_location:i,action_reason:c},experience:{page_name:u.page_name,page_name_detailed:u.page_name_detailed}}}(n);return"additional_context"in n.event_data&&(e.additional_context=n.event_data.additional_context),"form"in n.event_data&&(e.form=n.event_data.form),"user"in n.event_data&&(e.user=n.event_data.user),e},S=function(n,e){var t,o,r,a=null===(o=e,t=null!==(h=null===(r=n)||void 0===r?void 0:r.find((function(n){return n.eventName===o})))&&void 0!==h?h:null)||void 0===t?void 0:t.payload;if(a){var i=function(n,e){try{var t=JSON.parse(n);return e in t.events?Object.values(t.events[e]).at(0):null}catch(o){return null}}(a,e);return null!=i?i:null}return null},w=function(n){var e=function(n){var e=n.variant,t=n.cmsToken,o=n.scenario,r=n.success,a="".concat(window.location.pathname).concat(window.location.search),i=encodeURIComponent(a);if(!r)return"/login/error?redirectTo=".concat(i);switch(e){case"ONE_KEY":case"BETA_CONSENT_0":case"BETA_CONSENT_1":case"BETA_CONSENT_2":case"ONE_IDENTITY_1":case"ONE_IDENTITY_0":case"ONE_IDENTITY_2":return"/onboarding?originUrl=".concat(i,"&cmsToken=").concat(t,"&scenario=").concat(o);case"PASSWORD_1":case"PASSWORD_3":case"PASSWORD_0":case"PASSWORD_2":return"/addpassword?redirectTo=".concat(i,"&token=").concat(t,"&scenario=").concat(o,"&variant=").concat(e);case"PROFILE_DETAIL_0":case"PROFILE_DETAIL_1":return"/accountinfo?redirectTo=".concat(i,"&token=").concat(t,"&scenario=").concat(o,"&variant=").concat(e);case"PROFILE_DETAIL_2":return"/marketingconsent?redirectTo=".concat(i,"&token=").concat(t,"&scenario=").concat(o,"&variant=").concat(e);default:return null}}(n);null===e?window.location.reload():window.location.assign(e)},k={fragment:(0,a.Ps)(m())},x={fragment:(0,a.Ps)(_())},N=(0,a.Ps)(b(),k.fragment,x.fragment),P="__googleOneTapScript__",R="idle",C="loading",D="ready",L="error",G="load",j="error",F="google_onetap.failed",W=(0,a.Ps)(O(),x.fragment),q=function(n){var e,t,r,a,i=n.disabled,u=n.googleAccountConfigs,l=n.disableCancelOnUnmount,s=void 0!==l&&l,d=n.initialize,f=void 0!==d&&d,y=n.analytics,g=(e="https://accounts.google.com/gsi/client",t=p((0,o.useState)(e?C:R),2),r=t[0],a=t[1],(0,o.useEffect)((function(){if(e){var n=document.querySelector('script[src="'.concat(e,'"]'));if(n)a(n.getAttribute("data-status")||R);else{(n=document.createElement("script")).src=e,n.async=!0,n.setAttribute("data-status",C),document.body.appendChild(n);var t=function(e){n&&n.setAttribute("data-status",e.type===G?D:L)};n.addEventListener(G,t),n.addEventListener(j,t)}var o=function(n){a(n.type===G?D:L)};return n.addEventListener(G,o),n.addEventListener(j,o),function(){n&&(n.removeEventListener(G,o),n.removeEventListener(j,o))}}a(R)}),[e]),r),m=(0,c.useEgClickstream)();return(0,o.useEffect)((function(){var n,e;if(f&&!(null===(n=window)||void 0===n?void 0:n[P])&&window.google&&"ready"===g&&(window.google.accounts.id.initialize(function(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{},o=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(t).filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})))),o.forEach((function(e){v(n,e,t[e])}))}return n}({},u)),window[P]=!0),f&&(null===(e=window)||void 0===e?void 0:e[P])&&"ready"===g&&!i)return window.google.accounts.id.prompt((function(n){var e,t,o;if("user_cancel"===(null===(e=n)||void 0===e?void 0:e.getSkippedReason())){var r=S(y,"google_onetap.closed");r&&m(A(r))}if("tap_outside"===(null===(t=n)||void 0===t?void 0:t.getSkippedReason())){var a=S(y,"google_onetap.hidden");a&&m(A(a))}if(null===(o=n)||void 0===o?void 0:o.isDisplayed()){var i=S(y,"google_onetap.presented");i&&m(A(i))}})),function(){s||window.google.accounts.id.cancel()}}),[g,f,i,s]),null};function K(n){var e=n.children,t=void 0===e?null:e,o=f(n,["children"]);return q(o),t}var U={fragment:(0,a.Ps)(I())},$=(0,a.Ps)(E(),U.fragment,k.fragment,N),z=function(n){var e,t,a=n.data,i=a.configuration,l=a.analytics,s=a.action,v=(null===(e=i)||void 0===e?void 0:e.clientId)||"",f=p((0,o.useState)(!1),2),y=f[0],m=f[1];(0,o.useEffect)((function(){m(!0)}),[]);var _,b=(0,c.useEgClickstream)(),O=function(){var n,e=(0,r.v)().context,t=p((0,u.D)(W),1)[0],a=(0,c.useEgClickstream)(),i=(0,o.useCallback)((n=d((function(n,o){var r,i,c,u,l,s,d,v,f,p,y,m,_,b,O,I,E,T,h,k,x,N;return g(this,(function(g){switch(g.label){case 0:i=o.nonce,c=void 0===i?"":i,u=o.context,l=void 0===u?"":u,s=o.atoActions,d=void 0===s?[]:s,v=o.clickStreamAnalytics,f=(null===(r=d)||void 0===r?void 0:r.filter((function(n){return"IdentityCsrfWidgetAction"===n.__typename}))[0])||{},p={type:null===(R=P=f)||void 0===R?void 0:R.type,inputs:[{key:P.inputKeys[0],value:P[P.inputKeys[0]]}]},g.label=1;case 1:return g.trys.push([1,3,,4]),[4,t({variables:{context:e,submitRequest:{context:l,atoInputs:p,socialInput:{socialType:"GOOGLE",tokenType:"ID",token:n,nonce:c},input:[]}}})];case 2:return _=g.sent(),b=_.data,"IdentityGoogleOneTapMutationResponse"===(null===(m=b)||void 0===m||null===(y=m.googleOneTapSubmit)||void 0===y?void 0:y.__typename)&&(I=b.googleOneTapSubmit,E=I.analytics,T=I.variant,I.success?"ORIGIN"!==T?(h=S(E,"google_onetap.succeeded"))&&a(A(h)):(k=S(E,"sign_in.succeeded"))&&a(A(k)):(x=S(E,F))&&a(A(x)),w(null===(O=b)||void 0===O?void 0:O.googleOneTapSubmit)),[3,4];case 3:return g.sent(),(N=S(v,F))&&a(A(N)),w({success:!1}),[3,4];case 4:return[2]}var P,R}))})),function(e,t){return n.apply(this,arguments)}),[e]);return{authenticateWithGoogleOneTap:i}}().authenticateWithGoogleOneTap,I=(_=d((function(n){var e,t,o,r,a;return g(this,(function(i){switch(i.label){case 0:return(o=S(null===(e=s)||void 0===e?void 0:e.clickStreamAnalytics,"google_onetap.submitted"))&&b(A(o)),(null===(t=n)||void 0===t?void 0:t.credential)?[4,O(n.credential,s)]:[3,2];case 1:return i.sent(),[3,3];case 2:(a=S(null===(r=s)||void 0===r?void 0:r.clickStreamAnalytics,F))&&b(A(a)),i.label=3;case 3:return[2]}}))})),function(n){return _.apply(this,arguments)});return o.createElement(K,{googleAccountConfigs:{client_id:v,callback:I,nonce:null===(t=s)||void 0===t?void 0:t.nonce,itp_support:!1},initialize:y,analytics:l})};z.fragment=$,z.displayName="IdentityGoogleOneTapResponse";var B=(0,a.Ps)(T(),z.fragment),Y=function(n){var e,t=n.skipSsr,a=(0,r.v)().context,c={context:a},u=(0,i.a)(B,{context:a,variables:c,ssr:!t}),l=u.data,s=u.error;return u.loading||s||!l?null:"IdentityGoogleOneTapResponse"===(null===(e=l.googleOneTap)||void 0===e?void 0:e.__typename)?o.createElement(z,{data:l.googleOneTap}):null};Y.displayName="sharedui-GoogleOneTapQueryComponent";var H=function(n){var e,t,a=n.skipSsr;return"AUTHENTICATED"===(null===(t=(0,r.v)().context)||void 0===t||null===(e=t.identity)||void 0===e?void 0:e.authState)?null:o.createElement(Y,{skipSsr:a})};H.displayName="sharedui-GoogleOneTap"}}]);
//# sourceMappingURL=shared-ui-retail-identity-google-one-tap.4ca0117ada79cf883dee.js.map