/*@license For license information please refer to shared-ui-retail-product-gallery.licenses.txt*/
(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[3701],{95358:function(e,n,t){t.d(n,{L:function(){return ke}});var a=t(67294),l=t(69430),r=t(71641),i=t(95878),o=t(61348),c=t(73030),u=t(19633),d=t(25534),m=t(98250),g=t(64418),s=t(89313),v=t(23933),y=t(41496),f=t(70245),p=t(36101),I=t(62679),h=t(79183),b=t(84829),E=t(11719),k=t(55242),C=t(4372),S=t(58202),T=t(70272),P=t(30881),_=t(33933),w=t(85651);function x(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,a=new Array(n);t<n;t++)a[t]=e[t];return a}function G(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function L(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},a=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),a.forEach((function(n){G(e,n,t[n])}))}return e}function O(e,n){return n=null!=n?n:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):function(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})),e}function D(e,n){if(null==e)return{};var t,a,l=function(e,n){if(null==e)return{};var t,a,l={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||(l[t]=e[t]);return l}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(l[t]=e[t])}return l}function A(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var a,l,r=[],i=!0,o=!1;try{for(t=t.call(e);!(i=(a=t.next()).done)&&(r.push(a.value),!n||r.length!==n);i=!0);}catch(c){o=!0,l=c}finally{try{i||null==t.return||t.return()}finally{if(o)throw l}}return r}}(e,n)||N(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function M(e,n){return n||(n=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}}))}function H(e){return function(e){if(Array.isArray(e))return x(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||N(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function N(e,n){if(e){if("string"==typeof e)return x(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(t):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?x(e,n):void 0}}function V(){var e=M(["\n  fragment GalleryButtonsFragment on ProductImageGallery {\n    galleryButtons {\n      accessibility\n      icon {\n        id\n      }\n      action {\n        resource {\n          value\n        }\n      }\n    }\n  }\n"]);return V=function(){return e},e}function R(){var e=M(["\n  fragment PropertyImageFragment on ProductImageInfo {\n    image {\n      url\n      description\n      analytics {\n        linkName\n        referrerId\n      }\n    }\n    lowResImage {\n      url\n    }\n    analytics {\n      trackingId\n      imageId\n      subjectId\n    }\n  }\n"]);return R=function(){return e},e}function F(){var e=M(["\n  fragment CarouselContainerFragment on ProductImageGallery {\n    accessibilityLabel\n    categoryIdAll\n    categorizedImages {\n      accessibilityLabel\n      images {\n        ...PropertyImageFragment\n      }\n    }\n    ...GalleryButtonsFragment\n  }\n\n  ","\n  ","\n"]);return F=function(){return e},e}function z(){var e=M(["\n  fragment MosaicContainerFragment on ProductImageGallery {\n    accessibilityLabel\n    categorizedImages {\n      accessibilityLabel\n      images {\n        ...PropertyImageFragment\n      }\n    }\n    ...GalleryButtonsFragment\n  }\n\n  ","\n  ","\n"]);return z=function(){return e},e}function j(){var e=M(["\n  fragment MediaGalleryDialogFragment on ProductImageGallery {\n    categorizedImages {\n      categoryId\n      categoryName\n      images {\n        ...PropertyImageFragment\n      }\n    }\n    mediaGalleryDialog {\n      toolbar {\n        icon {\n          id\n          description\n        }\n      }\n    }\n  }\n  ","\n"]);return j=function(){return e},e}function U(){var e=M(["\n  fragment ThumbnailGalleryDialogFragment on ProductImageGallery {\n    categorizedImages {\n      categoryId\n      categoryName\n      images {\n        ...PropertyImageFragment\n      }\n    }\n    thumbnailGalleryDialog {\n      toolbar {\n        title\n        icon {\n          id\n          description\n        }\n      }\n      trigger {\n        accessibilityLabel\n        value\n      }\n    }\n  }\n  ","\n"]);return U=function(){return e},e}function B(){var e=M(["\n  fragment ProductGalleryImageContainerFragment on ProductImageGallery {\n    ...MosaicContainerFragment\n    ...CarouselContainerFragment\n    ...MediaGalleryDialogFragment\n    ...ThumbnailGalleryDialogFragment\n  }\n  ","\n  ","\n  ","\n  ","\n"]);return B=function(){return e},e}function X(){var e=M(["\n  query ProductGalleryQuery($context: ContextInput!, $productIdentifier: ProductIdentifierInput!) {\n    productGallery(context: $context, productIdentifier: $productIdentifier) {\n      ...ProductGalleryImageContainerFragment\n    }\n  }\n\n  ","\n"]);return X=function(){return e},e}var Y=function(e,n,t){return t.includes("clickRight")?e<n-1?e+1:0:t.includes("clickLeft")?e>0?e-1:n-1:e};function W(e,n,t,a,l,r,i){var o=[{imageGalleryMetaTagValue:Date.now().toString(),imageGalleryMetaTagType:"DEVICE_TIME_STAMP"}];return i&&o.push({imageGalleryMetaTagValue:i,imageGalleryMetaTagType:"GALLERY_FILTER"}),[{schemaName:"allHotelProducts",messageContent:{hotelProducts:[L({imageGalleryAlgorithm:{name:"heroaesthetics.v20190411-hsc.v20190223"},algoMediaGuid:n},l?{productId:Number(l)}:{})]}},{schemaName:"imageTracking",messageContent:L({galleryName:r,galleryType:"GALLERY_TYPE_SINGLE",galleryMaxPosition:t,galleryPosition:e,repeatedGalleryIndex:null,imageGalleryMetaTagList:o},a?{images:[{id:a,galleryPosition:e}]}:{})}]}function $(e){return e.map((function(e){var n,t,a,l,r;return{src:null!==(a=e.image.url)&&void 0!==a?a:"",caption:null!==(l=null===(n=e.image)||void 0===n?void 0:n.description)&&void 0!==l?l:"",alt:null!==(r=null===(t=e.image)||void 0===t?void 0:t.description)&&void 0!==r?r:""}}))}function K(e){return e.map((function(e){var n,t,a,l,r,i;return{src:null!==(l=e.image.url)&&void 0!==l?l:"",caption:null!==(r=e.image.description)&&void 0!==r?r:"",alt:null!==(i=e.image.description)&&void 0!==i?i:"",thumbnailClickAnalytics:null===(n=e.image)||void 0===n?void 0:n.analytics,trackingId:(null===(t=e.analytics)||void 0===t?void 0:t.trackingId)||null,imageId:(null===(a=e.analytics)||void 0===a?void 0:a.imageId)||null}}))}var Q=(0,l.Ps)(V()),Z={position:{zindex:"layer2",bottom:"three",right:"three"},type:"absolute"},q=function(e){var n,t=e.data,l=e.onThumbnailGalleryClick,r=e.onVirtualTourClick,i=e.thumbnailButtonText,o=e.thumbnailDialogTriggerAccessibilityLabel,c=t.galleryButtons,u=(0,m.useClickTracker)(),d=a.useCallback((function(e){var n,t,a;if(null===(a=c)||void 0===a||null===(t=a[e])||void 0===t||null===(n=t.action)||void 0===n?void 0:n.resource){var l,i,o,u,d=(null===(u=c)||void 0===u||null===(o=u[e])||void 0===o||null===(i=o.action)||void 0===i||null===(l=i.resource)||void 0===l?void 0:l.value)||"";r(d)}}),[c,r]),g=a.useMemo((function(){return{id:"HOT.HIS.PhotoGalleryTrigger",description:"Open Room Gallery dialog",callback:function(e,n){return u(e,n)}}}),[u]);return a.createElement(f.Y8,L({},Z),a.createElement(y.lu,{space:"two",wrap:"nowrap"},null===(n=c)||void 0===n?void 0:n.map((function(e,n){var t,l;return a.createElement(s.fF,{key:"gallery-mosaic-action-".concat(null===(t=e.icon)||void 0===t?void 0:t.id),"aria-label":"gallery-mosaic-action",onClick:function(){return d(n)}},a.createElement(v.nn,{name:(null===(l=e.icon)||void 0===l?void 0:l.id)||"",id:"gallery-mosaic-action-trigger"}),e.accessibility)})),a.createElement(s.fF,{"aria-label":o||"",onClick:l,analytics:g},a.createElement(v.nn,{name:"photo_library",id:"gallery-mosaic-thumbnail-trigger"}),i)))};q.displayName="GalleryButtons",q.fragment=Q;var J=function(e){var n,t,l,r,i=e.imageIndex,o=e.images,c=e.propertyId,u=e.children;return a.createElement(m.IntersectionTracker,{tag:"span",referrerId:"HOT.HIS.MosaicTileImageImpression.".concat(i),linkName:"Mosaic Tile Image Impression",trackOnce:!0,additionalUisPrimeMicroMessages:W(i,null===(t=o[i])||void 0===t||null===(n=t.analytics)||void 0===n?void 0:n.trackingId,o.length,null===(r=o[i])||void 0===r||null===(l=r.analytics)||void 0===l?void 0:l.imageId,c,"PDP_MOSAIC")},u)},ee=(0,l.Ps)(R()),ne=function(e){var n,t,l,r=e.data,i=e.onClick,o=e.index,c=e.className,u=e.fetchPriority,d=e.galleryLength,s=e.propertyId,v=D(e,["data","onClick","index","className","fetchPriority","galleryLength","propertyId"]),y=r.image,f=r.lowResImage,I=r.analytics||{},h=I.trackingId,b=I.imageId,E=null===(n=y)||void 0===n?void 0:n.analytics,k=(0,m.useClickTracker)(),C=A(a.useState(!1),2),S=C[0],T=C[1],P=a.useCallback((function(){var e,n;E&&k(null===(e=E)||void 0===e?void 0:e.referrerId,null===(n=E)||void 0===n?void 0:n.linkName);i(o),T(!0)}),[i,o,E]),_=a.createElement(g.Experiment,{name:"PDP_gallery_category_grouping_optimisation",logExposure:S},a.createElement(g.ExperimentControl,null,a.createElement(p.xH,{alt:null!==(l=y.description)&&void 0!==l?l:"",placeholderImage:!0,src:(null===(t=f)||void 0===t?void 0:t.url)?f.url:y.url,additionalProps:{fetchPriority:u}}),a.createElement(p.CS,null,a.createElement("button",{onClick:P,type:"button"},a.createElement("span",{className:"is-visually-hidden"},y.description)))),a.createElement(g.ExperimentVariant,{bucket:1}));return a.createElement(p.A1,O(L({},v),{className:c,ratio:p.zT.R16_9}),E?a.createElement(m.IntersectionTracker,{trackOnce:!0,referrerId:"HOT.HIS.MosaicTileImageImpression.".concat(o),linkName:"Mosaic Tile Image Impression",additionalUisPrimeMicroMessages:W(o,h,d,b,s,"PDP_MOSAIC")},_):_)};ne.displayName="PropertyImage",ne.fragment=ee;var te=(0,l.Ps)(F(),q.fragment,ne.fragment),ae=function(e){var n,t,l,r,i=e.data,o=e.allImages,c=e.onImageClick,u=e.onVirtualTourClick,s=e.onTriggerClick,v=e.imageIndexState,y=e.propertyId,f=i.galleryButtons,p=i.accessibilityLabel,I=(0,m.useClickTracker)(),h=A(a.useState(!1),2),b=h[0],E=h[1],k=A(a.useState(!1),2),C=(k[0],k[1]),S=A(v,2),T=S[0],P=S[1],_=a.useMemo((function(){return{id:"HOT.HIS.Main",description:"Change image in gallery carousel",callback:function(e,n){var t,a=Y(T,o.length,e),l=(null===(t=o[a])||void 0===t?void 0:t.analytics)||{},r=l.trackingId,i=l.imageId;I(e,n,void 0,W(a,r,o.length,i,y,"PDP_MOSAIC"))}}}),[I]),w=a.useCallback((function(e){P(e),E(!0)}),[P,E]),x=a.useCallback((function(){var e,n,t,a,l,r,i,u,d=o[T],m=null===(n=d)||void 0===n||null===(e=n.image)||void 0===e?void 0:e.analytics;m&&I(null===(i=m)||void 0===i?void 0:i.referrerId,null===(u=m)||void 0===u?void 0:u.linkName);I("HOT.HIS.LaunchMainPhotoGallery","Launch Photo Gallery From Image Click",void 0,W(T,null===(a=d)||void 0===a||null===(t=a.analytics)||void 0===t?void 0:t.trackingId,o.length,null===(r=d)||void 0===r||null===(l=r.analytics)||void 0===l?void 0:l.imageId,y,"PDP_MOSAIC")),c(),E(!0),C(!0)}),[I,c]),G=a.useCallback((function(){I("HOT.HIS.PhotoGalleryTrigger","Open Room Gallery dialog"),s(),E(!0)}),[I,s]),L=null===(n=f)||void 0===n?void 0:n.find((function(e){var n,t;return null===(t=e.action)||void 0===t||null===(n=t.resource)||void 0===n?void 0:n.value})),O=a.useCallback((function(){var e;(null===(e=L)||void 0===e?void 0:e.action)&&u(L.action.resource.value)}),[u,L]),D=a.useMemo((function(){return $(o)}),[o]);(null===(t=L)||void 0===t?void 0:t.accessibility)&&(l={virtualTourButton:null===(r=L)||void 0===r?void 0:r.accessibility});var M=a.createElement(J,{propertyId:y,images:o,imageIndex:T},a.createElement(d.A7,{carouselId:"property-details-carousel",allyHeadingLevel:2,analytics:_,allyHeadingText:p||"",buttonText:l,carouselName:"PhotoGallery",images:D,onImageClick:x,onIndexChange:w,showGalleryButton:!0,showVirtualTourButton:Boolean(L),onMediaButtonClick:G,onVirtualTourClick:O,currentIndex:T,enablePreload:!1,fetchPriority:"high"}));return a.createElement(g.Experiment,{name:"mWeb_PDP_Full_image_gallery_ranking_algorithm_with_new_scene_classifier",logExposure:b},a.createElement(g.ExperimentControl,null,M),a.createElement(g.ExperimentVariant,{bucket:1}))};ae.displayName="CarouselContainer",ae.fragment=te;var le=(0,l.Ps)(z(),q.fragment,ne.fragment);var re=function(e){var n,t=e.data,l=e.allImages,r=e.imagesToShow,i=e.onVirtualTourClick,o=e.onImageClick,c=e.onTriggerClick,u=e.thumbnailDialogTriggerTitle,d=e.thumbnailDialogTriggerAccessibilityLabel,g=e.propertyId,s=t.accessibilityLabel,v=(0,m.useClickTracker)(),y=a.useMemo((function(){var e=l.slice(0,r);return e.length%2==0&&e.pop(),e}),[l,r]),p=a.useCallback((function(e){var n,t=(null===(n=y[e])||void 0===n?void 0:n.analytics)||{},a=t.trackingId,l=t.imageId;v("HOT.HIS.ClickMosaicTileImage.".concat(e),"Property mosaic tile image click",void 0,W(e,a,y.length,l,g,"PDP_MOSAIC")),v("HOT.HIS.LaunchMainPhotoGallery","Launch Photo Gallery From Image Click"),o(e)}),[v,o]),h=function(e){switch(e){case 5:return 4;case 3:return 3;default:return 1}}(y.length);return a.createElement(f.Y8,{type:"relative"},a.createElement(I.PX,{columns:h,rows:2,space:"half"},a.createElement("meta",{itemProp:"image",content:null===(n=y[0])||void 0===n?void 0:n.image.url}),a.createElement("h2",{className:"is-visually-hidden"},s),y.map((function(e,n){return a.createElement(I.UX,{key:"mosaic-image-".concat(n),colSpan:0===n?2:1,rowSpan:0===n?2:1},a.createElement(ne,{data:e,onClick:p,index:n,fetchPriority:0===n?"high":void 0,galleryLength:r,propertyId:g}))})),a.createElement(q,{data:t,onThumbnailGalleryClick:c,onVirtualTourClick:i,thumbnailButtonText:u,thumbnailDialogTriggerAccessibilityLabel:d})))};re.fragment=le,re.displayName="MosaicContainer";var ie=(0,l.Ps)(j(),ne.fragment),oe=function(e){var n,t=e.data,l=e.allImages,r=e.isDialogOpen,i=e.onDialogDismiss,o=e.imageIndexState,c=e.categoryImageIndexState,u=e.categoryIndexState,d=e.propertyId,g=t.categorizedImages,s=t.mediaGalleryDialog,v=A(o,2),y=v[0],f=v[1],p=A(c,2),I=p[0],b=p[1],E=A(u,1)[0],k=(0,m.useClickTracker)(),C=a.useMemo((function(){var e;return $(E<0?l:(null===(e=g?g[E]:null)||void 0===e?void 0:e.images)||[])}),[E,g,l]),S=a.useMemo((function(){var e,n,t,a,l,r;return{type:null===(t=s)||void 0===t||null===(n=t.toolbar)||void 0===n||null===(e=n.icon)||void 0===e?void 0:e.id,navIconLabel:null===(r=s)||void 0===r||null===(l=r.toolbar)||void 0===l||null===(a=l.icon)||void 0===a?void 0:a.description}}),[s]),T=a.useMemo((function(){return{id:"HOT.HIS.PhotoGalleryTrigger",description:"Change image in media gallery",callback:function(e,n){var t,a,r,i=Y(I,C.length,e),o=(null===(r=((null===(a=g)||void 0===a||null===(t=a[E])||void 0===t?void 0:t.images)||l)[i])||void 0===r?void 0:r.analytics)||{},c=o.trackingId,u=o.imageId;k(e,n,void 0,W(I,c,C.length,u,d,"PDP_FULL_SCREEN_IMAGE_GALLERY"))}}}),[k]),P=a.useMemo((function(){return{id:"HOT.HIS.PhotoGalleryTrigger",description:"Close review gallery dialog",callback:function(e,n){return k(e,n)}}}),[k]),_=a.useCallback((function(e){E<0?f(e):b(e)}),[E,b,f]);if(!(null===(n=C)||void 0===n?void 0:n.length))return null;var w={currentIndex:E>=0?I:y,onIndexChange:_,galleryName:"Dialog",analytics:T};return a.createElement(h.St,L({dialogShow:r,onDismiss:i,strictFullscreen:!0,analytics:P},S),a.createElement(h.$x,O(L({},w),{images:C,stretchToFill:!1})))};oe.displayName="MediaGalleryDialog",oe.fragment=ie;var ce=function(e){var n,t=e.images,l=e.onImageSelected,r=e.columns,i=e.space,o=e.imagesRatio,c=e.focusIndex,u=e.containerRef,d=e.propertyId,g=e.categoryId;return(null===(n=t)||void 0===n?void 0:n.length)?a.createElement(_.EU,{bullet:"no-bullet",spacing:!1},a.createElement(I.PX,{columns:r,space:i},t.map((function(e,n){return a.createElement(I.UX,{key:n},a.createElement("div",{"data-stid":"image-thumbnail-view-with-label"},e.thumbnailClickAnalytics&&a.createElement(m.IntersectionTracker,{trackOnce:!0,referrerId:"HOT.HIS.ThumbnailImageImpression.".concat(g?"".concat(g,"."):"").concat(n),linkName:"Thumbnail Image Impression",additionalUisPrimeMicroMessages:W(n,e.trackingId,t.length,e.imageId,d,"PDP_FULL_IMAGE_GALLERY",g)},a.createElement(h.L0,O(L({},e),{index:n,imagesRatio:o,onImageSelected:function(){return l(n)},focusIndex:c,containerRef:u}))),!e.thumbnailClickAnalytics&&a.createElement(h.L0,O(L({},e),{index:n,imagesRatio:o,onImageSelected:function(){return l(n)},focusIndex:c,containerRef:u})),a.createElement(b.H3,{margin:{blockstart:"two",blockend:"three"}},a.createElement(T.sc,{align:"left",overflow:"truncate","aria-hidden":"true"},e.caption))))})))):null};ce.displayName="MediaGalleryThumbnailView";var ue=function(e){var n,t,l=e.categories,r=e.images,i=e.useCenteredSheet,o=e.onImageClick,c=e.categoryIndexState,d=e.imageIndexState,s=e.propertyId,v=e.showImageNumber,h=void 0!==v&&v,E=e.refGallery,k=e.isSmallView,_=A(d,1)[0],w=A(c,1)[0],x=a.useRef(null),G=a.useRef({}),L=a.useRef(null),O=(0,m.useClickTracker)(),D=(0,g.useExperiment)("Wider_centred_sheet_for_the_image_gallery").exposure,M=(0,u.useMediaQueries)({viewSizes:u.defaultViewSizes})>=u.defaultViewSizes.LARGE,H=2===D.bucket&&M?3:2,N=A(a.useState(w>=0||!(null===(n=l)||void 0===n?void 0:n.length)?w:0),2),V=N[0],R=N[1],F=A(a.useState([]),2),z=F[0],j=F[1];a.useEffect((function(){var e,n=new Array(null===(e=l)||void 0===e?void 0:e.length).fill(!1);n[0]=!n[0],j(n)}),[l]);var U=a.useCallback((function(e){var n,t,a,r,i,o;if(l){var c,u=e>=0?null===(c=l[e])||void 0===c?void 0:c.categoryId:"";O("HOT.HIS.PhotoGalleryTrigger.".concat(u,".").concat(e),"Selected gallery tab")}var d=new Array(z.length).fill(!1);d[e]=!0,j(d),R(e);var m=(null===(n=G.current[e])||void 0===n?void 0:n.offsetTop)||0,g=(null===(a=L.current)||void 0===a||null===(t=a.offsetParent)||void 0===t?void 0:t.clientHeight)||0;null===(o=E)||void 0===o||null===(i=o.current)||void 0===i||null===(r=i.offsetParent)||void 0===r||r.scrollTo(0,m-g)}),[R,l,O,z.length,E]),B=a.useCallback((function(e){if(V){var n,t,a,i,c,u,d=(null===(n=l)||void 0===n?void 0:n[V])||{},m=d.categoryId,g=d.images,v=void 0===g?[]:g,y=(null===(t=v[e])||void 0===t?void 0:t.analytics)||{},f=y.trackingId,p=y.imageId,I=null===(i=v[e])||void 0===i||null===(a=i.image)||void 0===a?void 0:a.analytics,h=v.length;if(O("HOT.HIS.ClickThumbnailImage.".concat(m,".").concat(e),"Launch Thumbnail Gallery From Image Click",void 0,W(e,f,h,p,s,"PDP_FULL_IMAGE_GALLERY")),I)O(null===(c=I)||void 0===c?void 0:c.referrerId,null===(u=I)||void 0===u?void 0:u.linkName);o(e,V)}else{var b,E,k,C,S,T=(null===(b=r[e])||void 0===b?void 0:b.analytics)||{},P=T.trackingId,_=T.imageId,w=null===(k=r[e])||void 0===k||null===(E=k.image)||void 0===E?void 0:E.analytics;if(O("HOT.HIS.ClickThumbnailImage.".concat(e),"Launch Thumbnail Gallery From Image Click",void 0,W(e,P,r.length,_,s,"PDP_FULL_IMAGE_GALLERY")),w)O(null===(C=w)||void 0===C?void 0:C.referrerId,null===(S=w)||void 0===S?void 0:S.linkName);o(e,V)}}),[V,o,l,O,r,s]),X=a.useCallback((function(e,n,t){return a.createElement(ce,{imagesRatio:p.zT.R16_9,images:e,onImageSelected:B,columns:n,space:"three",focusIndex:_,propertyId:s,categoryId:t})}),[B,_,s]),Y=a.useCallback((function(e,n,t,l,r,o,c){var u,d=!(arguments.length>7&&void 0!==arguments[7])||arguments[7],m=c===V,g=a.createElement(a.Fragment,null,n&&a.createElement(b.H3,{padding:{blockend:"three"}},a.createElement(T.If,{tag:o,size:r,id:"category-".concat(c)},a.createElement("div",{ref:(u=c,function(e){G.current[u]=e})},n))),X(e,l,t));if(m)return d||i?a.createElement(b.H3,{padding:{inline:"three",blockend:"three"}},a.createElement("div",null,g)):g}),[X,i,V]),$=a.useCallback((function(e,n,t,l){return a.createElement(u.Viewport,null,a.createElement(u.ViewSmall,null,Y(e,n,t,1,4,"h4",l)),a.createElement(u.ViewMedium,null,Y(e,n,t,H,3,"h3",l)),a.createElement(u.ViewLarge,null,Y(e,n,t,H,3,"h3",l,!1)))}),[Y,H]),Q=a.useCallback((function(e,n){return $(K(e.images),e.categoryName,e.categoryId,n)}),[$]);if(!(null===(t=l)||void 0===t?void 0:t.length)||1===l.length)return $(K(r));var Z=a.createElement(a.Fragment,null,a.createElement(f.Y8,{type:"sticky",position:{top:"zero",zindex:"layer1"},display:"block"},a.createElement(b.H3,{padding:{small:{block:"one",inline:"three"},medium:{block:"one",inline:"three"},large:i?{block:"three",inline:"three"}:{block:"three",inline:"unset"}}},a.createElement(P.LG,{layout:"fullwidth",paddedViewRow:!1,canvasTheme:"primary"},a.createElement("div",{ref:L},a.createElement(S.Z,{direction:"horizontal"},a.createElement(b.H3,{padding:{small:{block:"three"},medium:{block:"three"},large:{block:"one"}}},a.createElement(y.lu,null,l.map((function(e,n){var t,l,r,i=e.images.length,o=h?"".concat(null===(t=e)||void 0===t?void 0:t.categoryName," (").concat(i,")"):null===(l=e)||void 0===l?void 0:l.categoryName;return a.createElement(C.M3,{key:"thumbail-gallery-pill-".concat(n),id:"thumbail-gallery-pill-".concat(n),checked:z[n],onChange:function(){return U(n)},value:null===(r=e)||void 0===r?void 0:r.categoryName},o)}))))))))),k?a.createElement(I.PX,{blockSize:"85vb"},a.createElement(S.Z,{direction:"vertical"},l.map((function(e,n){return Q(e,n)})))):l.map((function(e,n){return Q(e,n)})));return i?a.createElement(a.Fragment,null,a.createElement("div",{ref:x}),a.createElement(f.Y8,{type:"sticky",position:{top:"zero",zindex:"layer2"},cloneElement:!0},Z)):Z},de=function(e){var n,t,l=e.categories,r=e.images,i=e.useCenteredSheet,o=void 0!==i&&i,c=e.onImageClick,d=e.categoryIndexState,s=e.imageIndexState,v=e.propertyId,y=A(s,1)[0],I=A(d,1)[0],h=a.useRef(null),E=(0,m.useClickTracker)(),k=(0,g.useExperiment)("Wider_centred_sheet_for_the_image_gallery").exposure,C=(0,u.useMediaQueries)({viewSizes:u.defaultViewSizes})>=u.defaultViewSizes.LARGE,S=2===k.bucket&&C?3:2,P=A(a.useState(I>=0||!(null===(n=l)||void 0===n?void 0:n.length)?I:0),2),_=P[0],x=P[1],G=a.useCallback((function(e){var n;if(l){var t,a=e>=0?null===(t=l[e])||void 0===t?void 0:t.categoryId:"";E("HOT.HIS.PhotoGalleryTrigger.".concat(a,".").concat(e),"Selected gallery tab")}x(e),null===(n=h.current)||void 0===n||n.scrollIntoView({block:"nearest"})}),[x,l,E]),L=a.useCallback((function(e){if(_){var n,t,a,i,o,u,d=(null===(n=l)||void 0===n?void 0:n[_])||{},m=d.categoryId,g=d.images,s=void 0===g?[]:g,y=(null===(t=s[e])||void 0===t?void 0:t.analytics)||{},f=y.trackingId,p=y.imageId,I=null===(i=s[e])||void 0===i||null===(a=i.image)||void 0===a?void 0:a.analytics,h=s.length;if(E("HOT.HIS.ClickThumbnailImage.".concat(m,".").concat(e),"Launch Thumbnail Gallery From Image Click",void 0,W(e,f,h,p,v,"PDP_FULL_IMAGE_GALLERY")),I)E(null===(o=I)||void 0===o?void 0:o.referrerId,null===(u=I)||void 0===u?void 0:u.linkName);c(e,_)}else{var b,k,C,S,T,P=(null===(b=r[e])||void 0===b?void 0:b.analytics)||{},w=P.trackingId,x=P.imageId,G=null===(C=r[e])||void 0===C||null===(k=C.image)||void 0===k?void 0:k.analytics;if(E("HOT.HIS.ClickThumbnailImage.".concat(e),"Launch Thumbnail Gallery From Image Click",void 0,W(e,w,r.length,x,v,"PDP_FULL_IMAGE_GALLERY")),G)E(null===(S=G)||void 0===S?void 0:S.referrerId,null===(T=G)||void 0===T?void 0:T.linkName);c(e,_)}}),[_,c,l,E,r]),O=a.useCallback((function(e,n,t){return a.createElement(ce,{imagesRatio:p.zT.R16_9,images:e,onImageSelected:L,columns:n,space:"three",focusIndex:y,propertyId:v,categoryId:t})}),[L,y]),D=a.useCallback((function(e,n,t,l,r,i){var c=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],u=a.createElement(a.Fragment,null,n&&a.createElement(b.H3,{padding:{blockend:"three"}},a.createElement(T.If,{tag:i,size:r},n)),O(e,l,t));return c||o?a.createElement(b.H3,{padding:{inline:"three",blockend:"three"}},a.createElement("div",null,u)):u}),[O,o]),M=a.useCallback((function(e,n,t){return a.createElement(u.Viewport,null,a.createElement(u.ViewSmall,null,D(e,n,t,1,4,"h4")),a.createElement(u.ViewMedium,null,D(e,n,t,S,3,"h3")),a.createElement(u.ViewLarge,null,D(e,n,t,S,3,"h3",!1)))}),[D]),H=a.useCallback((function(e){return M(K(e.images),e.categoryName,e.categoryId)}),[M,o]);if(!(null===(t=l)||void 0===t?void 0:t.length)||1===l.length)return M(K(r));var N=a.createElement(w.yR,{tabsType:w.Gd.NATURAL,selectedTab:_,onTabSelect:G},l.map((function(e){return a.createElement(w.XA,{key:"thumbail-gallery-tab-".concat(e.categoryId),id:e.categoryId,name:e.categoryName,targetURI:"#"},H(e))})));return o?a.createElement(a.Fragment,null,a.createElement("div",{ref:h}),a.createElement(f.Y8,{type:"sticky",position:{top:"zero",zindex:"layer2"},cloneElement:!0},N)):N},me=(0,l.Ps)(U(),ne.fragment),ge=function(e){var n,t,l,r,i,c=e.data,d=e.allImages,s=e.isDialogOpen,v=e.onDialogDismiss,f=e.onImageClick,p=e.categoryIndexState,I=e.imageIndexState,h=e.triggerRef,C=e.propertyId,S=c.categorizedImages,T=c.thumbnailGalleryDialog,P=a.useRef(null),_=(0,m.useClickTracker)(),w={id:"HOT.HIS.PhotoGalleryTrigger",description:"Close thumbnail gallery dialog",callback:function(e,n){return _(e,n)}},x=T&&a.createElement(E.tv,{navigationContent:{onClick:v,onClickAnalytics:w,navType:null===(t=T.toolbar)||void 0===t||null===(n=t.icon)||void 0===n?void 0:n.id,navIconLabel:null===(r=T.toolbar)||void 0===r||null===(l=r.icon)||void 0===l?void 0:l.description},toolbarTitle:(null===(i=T.toolbar)||void 0===i?void 0:i.title)||""}),G={returnFocusOnClose:!0,isVisible:s,triggerRef:h},D=(0,g.useExperiment)("Wider_centred_sheet_for_the_image_gallery").exposure,A=(0,g.useExperiment)("Introduce_pills_and_numbers_in_the_image_gallery").exposure,M=function(e){return a.createElement(g.Experiment,{name:"Introduce_pills_and_numbers_in_the_image_gallery"},a.createElement(g.ExperimentControl,null,a.createElement(de,{categories:S,images:d,useCenteredSheet:0!==D.bucket,onImageClick:f,categoryIndexState:p,imageIndexState:I,propertyId:C})),a.createElement(g.ExperimentVariant,{bucket:1},a.createElement(ue,{categories:S,images:d,useCenteredSheet:0!==D.bucket,onImageClick:f,categoryIndexState:p,imageIndexState:I,propertyId:C,refGallery:P,isSmallView:e})),a.createElement(g.ExperimentVariant,{bucket:2},a.createElement(ue,{categories:S,images:d,useCenteredSheet:0!==D.bucket,onImageClick:f,categoryIndexState:p,imageIndexState:I,propertyId:C,showImageNumber:!0,refGallery:P,isSmallView:e})))},H=function(e){return a.createElement(a.Fragment,null,x,0===A.bucket?a.createElement(o.XM,{padded:!1},a.createElement("div",{ref:P},M(e))):a.createElement("div",{ref:P},M(e)))},N=a.createElement(o.A5,{type:"full",isVisible:s,triggerRef:h,returnFocusOnClose:!0},x,a.createElement(b.H3,{padding:{blockend:"three"}},a.createElement(o.XM,{padded:!1},a.createElement(y.lu,{justifyContent:"center"},a.createElement(y.Vt,{maxWidth:"312x",grow:1},a.createElement("div",{ref:P},M(!1)))))));return a.createElement(u.Viewport,null,a.createElement(u.ViewSmall,null,a.createElement(o.A5,O(L({},G),{type:"full"}),H(!0))),a.createElement(u.ViewMedium,null,a.createElement(g.Experiment,{name:"Wider_centred_sheet_for_the_image_gallery"},a.createElement(g.ExperimentControl,null,N),a.createElement(g.ExperimentVariant,{bucket:1},a.createElement(k.A,O(L({},G),{centeredSheetSize:"xxxlarge",height:1200}),H(!1))),a.createElement(g.ExperimentVariant,{bucket:2},a.createElement(k.A,O(L({},G),{centeredSheetSize:"xxxlarge",height:1200}),H(!1))))))};ge.displayName="ThumbnailGalleryDialog",ge.fragment=me;var se=function(e,n){var t=function(e){return(0,a.useMemo)((function(){var n,t,a;return(null===(a=e)||void 0===a||null===(t=a.categorizedImages)||void 0===t||null===(n=t.find((function(n){return n.categoryId===e.categoryIdAll})))||void 0===n?void 0:n.images)||[]}),[e])}(e);return(0,a.useMemo)((function(){var e;if(!(null===(e=n)||void 0===e?void 0:e.length)||!t.length)return t;var a=n.reduce((function(e,n){return O(L({},e),G({},n.imageId,n))}),{}),l=t.filter((function(e){var n;return(null===(n=e.analytics)||void 0===n?void 0:n.imageId)&&Boolean(a[e.analytics.imageId])&&e.lowResImage})).map((function(e){var n,t,l,r;return O(L({},e),{image:O(L({},e.image),{url:(null===(n=a[(null===(t=e.analytics)||void 0===t?void 0:t.imageId)||""])||void 0===n?void 0:n.url)||e.image.url}),lowResImage:O(L({},e.lowResImage),{url:(null===(l=a[(null===(r=e.analytics)||void 0===r?void 0:r.imageId)||""])||void 0===l?void 0:l.url)||""})})}));l.sort((function(e,t){var a,l;return((null===(a=n)||void 0===a?void 0:a.findIndex((function(n){var t;return n.imageId===(null===(t=e.analytics)||void 0===t?void 0:t.imageId)})))||-1)-((null===(l=n)||void 0===l?void 0:l.findIndex((function(e){var n;return e.imageId===(null===(n=t.analytics)||void 0===n?void 0:n.imageId)})))||-1)}));var r=t.filter((function(e){var n,t;return!(null===(n=e.analytics)||void 0===n?void 0:n.imageId)||!e.lowResImage||!((null===(t=e.analytics)||void 0===t?void 0:t.imageId)in a)}));return H(l).concat(H(r))}),[t,n])},ve=(0,l.Ps)(B(),re.fragment,ae.fragment,oe.fragment,ge.fragment),ye=function(e){var n,t,l,r,i,d,m=e.propertyId,g=e.data,s=e.placeholderData,v=e.className,y=A((0,c.useDialog)("media-gallery","pwaDialogNested"),3),f=y[0],p=y[1],I=y[2],h=A((0,c.useDialog)("thumbnail-gallery","pwaThumbnailDialog"),3),b=h[0],E=h[1],k=h[2],C=a.useRef(null),S=a.useRef(null),T=a.useState(0),P=a.useState(-1),_=a.useState(0),w=A(T,2)[1],x=A(P,2)[1],G=A(_,2)[1],O=se(g,s),D=a.useCallback((function(e){w(e),x(-1),C.current=document.activeElement,E.openDialog()}),[E,x,w]),M=a.useCallback((function(e){window.open(e)}),[]),H=a.useCallback((function(){x(-1),E.openDialog()}),[E,x]),N=a.useCallback((function(e,n){S.current=document.activeElement,x(n),G(e),n<0&&w(e),p.openDialog()}),[x,G,p,w]),V=a.useCallback((function(){var e=document.activeElement;C.current=e,w(0),E.openDialog()}),[E,w]),R=a.useCallback((function(){E.closeDialog(),setTimeout((function(){var e;null===(e=C.current)||void 0===e||e.focus()}),0)}),[E]),F=a.useCallback((function(){p.closeDialog(),setTimeout((function(){var e;null===(e=S.current)||void 0===e||e.focus()}),0)}),[p]);if(!g||!O.length)return null;var z={imageIndexState:T,categoryImageIndexState:_,categoryIndexState:P},j=L({onTriggerClick:V,onVirtualTourClick:M,thumbnailDialogTriggerTitle:null===(l=g)||void 0===l||null===(t=l.thumbnailGalleryDialog)||void 0===t||null===(n=t.trigger)||void 0===n?void 0:n.value,thumbnailDialogTriggerAccessibilityLabel:null===(d=g)||void 0===d||null===(i=d.thumbnailGalleryDialog)||void 0===i||null===(r=i.trigger)||void 0===r?void 0:r.accessibilityLabel,data:g,propertyId:m,allImages:O},z);return a.createElement("div",{className:v},a.createElement(u.Viewport,null,a.createElement(u.ViewSmall,null,a.createElement(ae,L({onImageClick:H},j))),a.createElement(u.ViewMedium,null,a.createElement(re,L({onImageClick:function(e){return D(e)},imagesToShow:3},j))),a.createElement(u.ViewLarge,null,a.createElement(re,L({onImageClick:function(e){return D(e)},imagesToShow:5},j)))),a.createElement(o.Xw,{isVisible:b},a.createElement(k,null,a.createElement(ge,L({allImages:O,data:g,isDialogOpen:b,onDialogDismiss:R,onImageClick:N,triggerRef:C,propertyId:m},z)))),a.createElement(o.Xw,{isVisible:f},a.createElement(I,null,a.createElement(oe,L({allImages:O,data:g,isDialogOpen:f,onDialogDismiss:F,propertyId:m},z)))))};ye.displayName="ProductGalleryImageContainer",ye.fragment=ve;var fe=function(e){var n=e.images,t=function(){var e=A((0,a.useState)(!1),2),n=e[0],t=e[1];return(0,a.useEffect)((function(){t(!0)}),[]),n}();return a.createElement(a.Fragment,null,t?a.createElement(he,{images:n}):a.createElement(be,{images:n}))},pe=function(e){var n,t,l=e.additionalImage,r=e.className,i=e.style;return a.createElement(p.A1,{ratio:p.zT.R16_9,className:r,style:i},a.createElement(p.xH,{placeholderImage:!0,src:null===(n=l)||void 0===n?void 0:n.url,alt:null===(t=l)||void 0===t?void 0:t.description}))},Ie=function(e){var n=function(e){var n,t=e.images;return a.createElement(u.Viewport,null,a.createElement(u.ViewSmall,null,a.createElement(pe,{additionalImage:null===(n=t)||void 0===n?void 0:n[0]})),a.createElement(u.ViewMedium,null,a.createElement(I.PX,{rows:2,columns:3,space:"half"},Array.from(Array(3)).map((function(e,n){var l;return a.createElement(I.UX,{rowSpan:0===n?2:1,colSpan:0===n?2:1,key:"gallery-placeholder-".concat(n)},a.createElement(pe,{additionalImage:null===(l=t)||void 0===l?void 0:l[n]}))})))),a.createElement(u.ViewLarge,null,a.createElement(I.PX,{rows:2,columns:4,space:"half"},Array.from(Array(5)).map((function(e,n){var l;return a.createElement(I.UX,{rowSpan:0===n?2:1,colSpan:0===n?2:1,key:"gallery-placeholder-".concat(n)},a.createElement(pe,{additionalImage:null===(l=t)||void 0===l?void 0:l[n]}))})))))};return n.displayName=e,n},he=Ie("CsrPlaceholder"),be=Ie("SsrPlaceholder"),Ee=(0,l.Ps)(X(),ye.fragment),ke=function(e){var n,t=e.inputs,l=e.skipSsr,o=e.placeholderData,c=e.batchKey,u=(0,i.v)().context,d=O(L({},t),{context:u}),m=(0,r.a)(Ee,{context:{batchKey:null!=c?c:"default-product-details-experience-batch-key"},variables:d,ssr:!l,errorPolicy:"all"}),g=m.data,s=m.loading,v=null===(n=g)||void 0===n?void 0:n.productGallery;return a.createElement(a.Fragment,null,s&&a.createElement(fe,{images:o}),a.createElement(ye,{propertyId:t.productIdentifier.id,data:v,placeholderData:o}))};ke.displayName="sharedui-ProductGallery"}}]);
//# sourceMappingURL=shared-ui-retail-product-gallery.dd0a15163a6b34675573.js.map