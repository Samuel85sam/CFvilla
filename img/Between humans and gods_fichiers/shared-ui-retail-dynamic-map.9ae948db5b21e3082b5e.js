/*@license For license information please refer to shared-ui-retail-dynamic-map.licenses.txt*/
(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[2625],{92081:function(e,n,t){t.d(n,{B5:function(){return G},JX:function(){return V},K6:function(){return L},KQ:function(){return T},iQ:function(){return z},lR:function(){return B},lq:function(){return K},mS:function(){return x}});var r=t(67294),i=t(70245),o=t(27630),a=t(59754),u=t(95878),l=t(98250),c=t(69430),d=t(37291),s=t(44916),p=t(36101),f=t(41496),v=t(62679),m=t(84829),g=t(70272);function y(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function b(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function _(e,n){return n=null!=n?n:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):function(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})),e}function C(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,i,o=[],a=!0,u=!1;try{for(t=t.call(e);!(a=(r=t.next()).done)&&(o.push(r.value),!n||o.length!==n);a=!0);}catch(l){u=!0,i=l}finally{try{a||null==t.return||t.return()}finally{if(u)throw i}}return o}}(e,n)||E(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function M(e,n){return n||(n=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}}))}function O(e){return function(e){if(Array.isArray(e))return y(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||E(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function E(e,n){if(e){if("string"==typeof e)return y(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(t):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?y(e,n):void 0}}function h(){var e=M(["\n  fragment DynamicMapFragment on EGDSBasicMap {\n    label\n    initialViewport\n    center {\n      latitude\n      longitude\n    }\n    zoom\n    bounds {\n      northeast {\n        latitude\n        longitude\n      }\n      southwest {\n        latitude\n        longitude\n      }\n    }\n    computedBoundsOptions {\n      coordinates {\n        latitude\n        longitude\n      }\n      gaiaId\n      lowerQuantile\n      upperQuantile\n      marginMultiplier\n      minMargin\n      minimumPins\n      interpolationRatio\n    }\n    config {\n      ... on EGDSDynamicMapConfig {\n        accessToken\n        egdsMapProvider\n        externalConfigEndpoint {\n          value\n        }\n        mapId\n      }\n    }\n    markers {\n      ... on EGDSMapFeature {\n        id\n        description\n        markerPosition {\n          latitude\n          longitude\n        }\n        type\n        markerStatus\n        qualifiers\n        text\n        clientSideAnalytics {\n          linkName\n          referrerId\n        }\n        onSelectAccessibilityMessage\n        onEnterAccessibilityMessage\n      }\n    }\n  }\n"]);return h=function(){return e},e}function P(){var e=M(["\n  fragment MapCardContentFragment on EGDSImageCard {\n    id\n    title\n    subTitle\n    description\n    image {\n      aspectRatio\n      description\n      thumbnailClickAnalytics {\n        eventType\n        linkName\n        referrerId\n        uisPrimeMessages {\n          messageContent\n          schemaName\n        }\n      }\n      url\n    }\n  }\n"]);return P=function(){return e},e}var S=function(e,n){return e.listFeatures((function(e){return n(e)&&e.visible}),e.getBounds()).length},k=function(e){var n,t,r,i,o;return(null===(n=e.qualifiers)||void 0===n?void 0:n.includes(a.my.AIRPORT))||(null===(t=e.qualifiers)||void 0===t?void 0:t.includes(a.my.TRANSPORTATION))||(null===(r=e.qualifiers)||void 0===r?void 0:r.includes(a.my.BUS_STATION))||(null===(i=e.qualifiers)||void 0===i?void 0:i.includes(a.my.TRANSIT))||(null===(o=e.qualifiers)||void 0===o?void 0:o.includes(a.my.METRO_STATION))},A=function(e,n){var t,r=null===(t=e)||void 0===t?void 0:t.getActiveTilesets(),i=S(e,(function(e){return"cluster"===e.type})),o=S(e,(function(e){return"property"===e.type})),u=S(e,k),l=S(e,(function(e){var n;return null===(n=e.qualifiers)||void 0===n?void 0:n.includes(a.my.POINT_OF_INTEREST)}));return{transportationCount:u,groceryCount:S(e,(function(e){var n;return null===(n=e.qualifiers)||void 0===n?void 0:n.includes(a.my.GROCERY)})),restaurantCount:S(e,(function(e){var n;return null===(n=e.qualifiers)||void 0===n?void 0:n.includes(a.my.RESTAURANT)})),placesOfInterestCount:l,tileSets:r,productClusterCount:i,propertyCount:o,origin:n}},w=function(e){var n=1e6;return Math.round((e+Number.EPSILON)*n)/n},I=function(e,n){var t=e.map(w),r=n.map(w);return"".concat(t,", ").concat(r)},T=function(e){return(null!=e?e:[]).map((function(e,n){var t,r,i=(e.type||"place").toString().toLowerCase(),o=(e.markerStatus||"unknown").toString().toLowerCase();return(e.onSelectAccessibilityMessage||e.onEnterAccessibilityMessage)&&(t={default:e.onEnterAccessibilityMessage||"",onSelect:e.onSelectAccessibilityMessage||""}),{id:e.id||"index-".concat(n),name:null!==(r=e.text)&&void 0!==r?r:void 0,lat:e.markerPosition.latitude,lng:e.markerPosition.longitude,type:i,status:o,qualifiers:O(e.qualifiers),text:"place"===i&&e.text||void 0,price:"property"===i?e.text:void 0,ariaLabels:t}}))},D=(0,c.Ps)(h()),N=(0,c.Ps)(P()),j="Interaction",R="Impression",B=function(e,n,t){return{event_name:e,event_type:n,event_version:t,event_category:"maps"}},z=function(e,n){return _(function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){b(e,n,t[n])}))}return e}({},n),{event:e})};function L(){var e=(0,l.useEgClickstream)(),n=function(n){e&&e(n)},t=(0,l.useClickTracker)();return{trackMapInit:function(e,t){var r=B("map.initiated",j,"2.3.0");n(z(r,{map_obj:{map_provider:e,map_selection_type:"property",map_selection_id:t}}))},trackMapPresented:function(e,t,r){var i=B("map.presented",R,"2.4.0");n(z(i,{map_obj:{map_identifier:t,visible_bounding_box:e,view_mode:r}}))},trackMapViewportMoved:function(e,t,r){var i=B("map_viewport.viewed",j,"3.2.0");n(z(i,{map_obj:{visible_bounding_box:e,movement_type:t,zoom_level:r}}))},trackMapContentPresented:function(e){var t=B("map_content.presented",R,"3.4.0"),r={map_obj:{tile_sets:e.tileSets,content_origin:e.origin},destination:{places_of_interest_count:e.placesOfInterestCount,restaurant_count:e.restaurantCount,grocery_count:e.groceryCount,transportation_count:e.transportationCount},map_product_detail:{product_cluster_count:e.productClusterCount,property_count:e.propertyCount}};n(z(t,r))},trackMapPlaceSelected:function(e,t,r,i){var o=B("map_place.selected",j,"3.10.1");n(z(o,{map_obj:{map_selection_id:e,map_selection_type:i,geometry_type_name:t,qualifiers:r}}))},trackMapPropertySelected:function(e,t){var r=B("map_product.selected",j,"1.0.1");n(z(r,{map_obj:{map_selection_id:e,map_selection_type:t}}))},trackMapHidden:function(){var e=B("map.hidden",j,"2.3.0");n(z(e,{}))},trackMapFilterChanged:function(e,n){t(e,n)},trackMapCustomPlaceAdded:function(e,t,r){var i=B("map_place.added",j,"1.0.0");n(z(i,{map_obj:{map_feature_id:r,map_search_type:e,map_search_detail:t}}))},trackMapCustomPlaceRemoved:function(e,t,r){var i=B("map_place.removed",j,"1.0.0");n(z(i,{map_obj:{map_feature_id:r,map_search_type:e,map_search_detail:t}}))},trackMapPlacesDialogOpened:function(){var e=B("map_dialog.opened",j,"1.0.0");n(z(e,{}))},trackMapPlacesDialogClosed:function(){var e=B("map_dialog.closed",j,"1.0.0");n(z(e,{}))}}}var x=function(e){return e.GAIA="gaia",e.GOOGLE="google",e}(x||{}),q="trackMapViewportBoundChangedCb",U="trackMarkerSelectionId",F="trackMapContentPresentedId",G=function(e){var n,t,c,s,p,f,v=e.children,m=e.data,g=e.className,y=e.beforeInit,b=e.onInit,_=e.initialViewport,M=e.initialMapConfig,E=e.supplementalFeatures,h=e.onFeaturesPushed,P=e.egMapsConfig,S=e.selectedFeatureId,k=e.viewMode,w=e.egDistancesEnabled,D=void 0!==w&&w,N=e.clientPadding,j=e.height,R=void 0===j?"100vh":j,B=e.updateViewport,z=void 0===B||B,x=m||{},G=x.initialViewport,V=x.center,K=x.zoom,X=x.bounds,Q=x.computedBoundsOptions,H=x.config,Z=x.markers,Y=r.useRef(),J=C(r.useState(!1),2),W=J[0],$=J[1],ee=r.useRef(),ne=((0,l.useClickTracker)(),L()),te=ne.trackMapInit,re=ne.trackMapPresented,ie=ne.trackMapViewportMoved,oe=ne.trackMapContentPresented,ae=ne.trackMapPlaceSelected,ue=ne.trackMapPropertySelected,le=ne.trackMapHidden,ce=(0,u.v)().context,de=ce.locale,se=ce.currency;r.useEffect((function(){m&&(ee.current=m)}),[m]);var pe=r.useMemo((function(){var e;return H||(null===(e=ee.current)||void 0===e?void 0:e.config)||M}),[M,H]);r.useEffect((function(){return le}),[]),r.useEffect((function(){var e;if(null===(e=pe)||void 0===e?void 0:e.egdsMapProvider){var n,t="MAPBOX"===(null===(n=pe)||void 0===n?void 0:n.egdsMapProvider)?"mapbox":"google-maps";te(t,S)}}),[null===(n=pe)||void 0===n?void 0:n.egdsMapProvider]);var fe=r.useMemo((function(){if(pe){var e,n=pe.mapId,t=pe.egdsMapProvider,r=pe.externalConfigEndpoint,i=[P||{}];i.push(g?{additionalCssClass:g}:{}),i.push(de?{locale:de}:{}),i.push(se?{iso4217CurrencyCode:se}:{});var o=null===(e=r)||void 0===e?void 0:e.value;if(i.push(o?{externalConfigEndpoint:o}:{}),n)if("MAPBOX"===t)i.push({mapbox:{mapboxAddConf:{style:n}}});else i.push({googleMaps:{gmapsAddConfig:{mapId:n}}});return d.T1.apply(void 0,[{}].concat(O(i)))}}),[null===(c=pe)||void 0===c||null===(t=c.externalConfigEndpoint)||void 0===t?void 0:t.value,null===(s=pe)||void 0===s?void 0:s.mapId,null===(p=pe)||void 0===p?void 0:p.egdsMapProvider,de,se,P]),ve=null===(f=pe)||void 0===f?void 0:f.accessToken,me=function(){var e;return"MAPBOX"===(null===(e=pe)||void 0===e?void 0:e.egdsMapProvider)?a.cB.MAPBOX:a.cB.GOOGLE}(),ge=r.useMemo((function(){var e;return O(T(null===(e=Z)||void 0===e?void 0:e.map((function(e){return e})))).concat(O(E||[]))}),[Z,E]),ye=r.useMemo((function(){var e;return null===(e=ge)||void 0===e?void 0:e.map((function(e){return[e.lat,e.lng]}))}),[ge]),be=function(e){var n,t,r,i;return{sw:[null===(n=e)||void 0===n?void 0:n.southwest.latitude,null===(t=e)||void 0===t?void 0:t.southwest.longitude],ne:[null===(r=e)||void 0===r?void 0:r.northeast.latitude,null===(i=e)||void 0===i?void 0:i.northeast.longitude]}},_e=function(e,n){var t,r;return{center:[null===(t=e)||void 0===t?void 0:t.latitude,null===(r=e)||void 0===r?void 0:r.longitude],zoom:n}},Ce=function(e,n){var t,r,i,o,a,u,l,c,d;return{useBoundsComputation:!0,options:{gaiaId:(null===(t=n)||void 0===t?void 0:t.gaiaId)&&!Number.isNaN(Number(null===(r=n)||void 0===r?void 0:r.gaiaId))?Number(null===(i=n)||void 0===i?void 0:i.gaiaId):void 0,lowerQuantile:null===(o=n)||void 0===o?void 0:o.lowerQuantile,upperQuantile:null===(a=n)||void 0===a?void 0:a.upperQuantile,marginMultiplier:null===(u=n)||void 0===u?void 0:u.marginMultiplier,minMargin:null===(l=n)||void 0===l?void 0:l.minMargin,minimumPins:null===(c=n)||void 0===c?void 0:c.minimumPins,interpolationRatio:null===(d=n)||void 0===d?void 0:d.interpolationRatio},coordinates:n.coordinates.length>0?n.coordinates.map((function(e){return[e.latitude,e.longitude]})):e}};r.useEffect((function(){var e=Y.current;if(z&&W&&e)switch(G){case"BOUNDS":if(X){var n=be(X),t=n.sw,r=n.ne;e.fitBounds(t,r,void 0,N)}break;case"CENTER_AND_ZOOM":if(null!==V&&null!==K){var i=_e(V,K),o=i.center,a=i.zoom;e.centerAndZoomMap(o,a,N)}break;case"COMPUTED_BOUNDS":if(Q){var u=Ce(ye,Q),l=u.useBoundsComputation,c=u.options,d=u.coordinates;e.boundsContaining(d,l,c).then((function(n){var t=n.sw,r=n.ne;e.fitBounds(t,r,void 0,N)}))}break;case"FIT_MARKERS":var s;(null===(s=ye)||void 0===s?void 0:s.length)>0&&e.fitLatLongs(ye,void 0,N);break;default:_&&e.centerAndZoomMap(_.center,_.zoom,N)}}),[W,G,V,K,X,Q,ye,z,N]);var Me=r.useMemo((function(){switch(G){case"BOUNDS":return X?be(X):void 0;case"CENTER_AND_ZOOM":return V&&null!==K?_e(V,K):void 0;case"COMPUTED_BOUNDS":return Q?Ce(ye,Q):void 0;case"FIT_MARKERS":return ye;default:return _}}),[_,G,V,K,X,Q,ye]),Oe=r.useCallback((function(e){var n,t={zoomIn:"zoom_in",zoomOut:"zoom_out",drag:"pan",zoomInKeyboard:"zoom_in",zoomOutKeyboard:"zoom_out",pitch:"pan",rotate:"pan",touch:"pan",moveKeyboard:"pan",clusterExtent:"zoom_in"}[null===(n=e)||void 0===n?void 0:n.originalEvent];void 0!==t&&ie(function(e){var n,t,r,i,o,a,u=[[null!==(n=e.sw[0])&&void 0!==n?n:0,null!==(t=e.sw[1])&&void 0!==t?t:0],[null!==(r=e.ne[0])&&void 0!==r?r:0,null!==(i=e.ne[1])&&void 0!==i?i:0]],l=[];return I(null!==(o=u[0])&&void 0!==o?o:l,null!==(a=u[1])&&void 0!==a?a:l)}(e.bounds),t,e.zoom)}),[ie]),Ee=r.useCallback((function(e){if(e){var n=e.type,t=e.id,r=void 0===t?null:t;if(n&&null!==r)switch(n){case"place":ae(r.toString(),"Point",e.qualifiers||[],"destination");break;case"property":ue(r.toString(),"property");break;case"cluster":ae(r.toString(),"Point",[],"cluster")}}}),[ae,ue]),he=r.useCallback((function(){setTimeout((function(){var e=A(Y.current,"tile");oe(e)}),200)}),[oe]),Pe=r.useCallback((function(e){"select"===e.action&&Ee(e.feature)}),[Ee]);r.useEffect((function(){Y.current&&Y.current.addBoundChangeListener(Oe,q)}),[Oe]),r.useEffect((function(){Y.current&&Y.current.addSelectionChangeListener(Pe,U)}),[Pe]),r.useEffect((function(){Y.current&&Y.current.addTilesContentLoadedListener(he,F)}),[he]);var Se=r.useCallback((function(e){Y.current=e,e.addBoundChangeListener(Oe,q),e.addSelectionChangeListener(Pe,U),e.addTilesContentLoadedListener(he,F),y&&y(e)}),[]),ke=r.useCallback((function(e){if($(!0),e){var n="";switch(me){case a.cB.MAPBOX:n=e.readConfigParam("mapbox,mapboxAddConf,style");break;case a.cB.GOOGLE:default:n=e.readConfigParam("googleMaps,gmapsAddConfig,mapId")}var t=e.getBounds();if(t){var r=I(t.sw,t.ne);re(r,n,k)}}b&&b(e)}),[b,re,k,me]),Ae=r.useCallback((function(e,n){n&&(setTimeout((function(){var n=A(e,"user");oe(n)}),200),h&&h(e,n))}),[h,oe]);return pe||W?r.createElement(a.j1,{accessToken:ve,mapType:me,initialViewport:Me,beforeInit:Se,onInit:ke,height:R,mapConfig:fe,features:ge,onFeaturesPushed:Ae,egDistancesEnabled:D,clientPadding:N},v):r.createElement("div",{style:{height:R}},r.createElement(i.Y8,{type:"relative",position:{top:"center",left:"center"}},r.createElement(o.M_,{visible:!0})))};G.displayName="DynamicMap",G.fragment=D;var V=function(e){return e[e.STANDARD=0]="STANDARD",e[e.COMPACT=1]="COMPACT",e}(V||{}),K=function(e){var n=e.data,t=e.size,i=e.imageRatio;if(!n||!n.title)return null;var o=n.image,a=n.subTitle,u=n.title,l=n.id,c=n.description,d=i||1===t?p.zT.R3_4:p.zT.R4_3,y=1===t?296:552;return r.createElement(m.H3,{margin:{inline:"three"}},r.createElement(s.m9,null,r.createElement("div",{"data-testid":"map-card-".concat(l)}),r.createElement(v.PX,{alignItems:"start",columns:4,style:{minHeight:63,minWidth:y}},o?r.createElement(v.UX,{colSpan:1},r.createElement(p.A1,{ratio:d,roundcorner:["startstart"]},r.createElement(p.xH,{src:o.url,alt:o.description,placeholderImage:!0}))):null,r.createElement(v.UX,{colSpan:o?3:4},r.createElement(f.lu,{direction:"column",blockSize:"full_size",justifyContent:"space-between"},r.createElement(f.Vt,null,r.createElement(s.oV,null,r.createElement(g.If,null,u),c?r.createElement(g.sc,{size:200,spacing:"one"},c):null)),r.createElement(f.Vt,null,r.createElement(s.oV,null,a?r.createElement(g.sc,{size:200},a):null)))))))};K.fragment=N,K.displayName="MapCardContent"}}]);
//# sourceMappingURL=shared-ui-retail-dynamic-map.9ae948db5b21e3082b5e.js.map